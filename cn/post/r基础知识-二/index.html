<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> 
    
    <link rel="stylesheet" href="../../../fonts/academicons-1.8.6/css/academicons.min.css"/>
    <link rel="icon" type="image/png" sizes="32x32" href="../../../logo/bodhi.png"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    
    <title>R基础知识（二） - Boylad</title>
    
     
    <meta property="og:title" content="R基础知识（二） - Guankui Liu | Boylad">
    

    
      
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="../../../css/style.css" />
    <link rel="stylesheet" href="../../../css/mystyle.css" /> 
    <link rel="stylesheet" href="../../../css/fonts.css" />
    
<script async src="../../../js/load-typekit.js"></script>


<link rel="stylesheet" href="../../../css/custom.css" />

  </head>

  
  <body class="cn">
    <header class="masthead">
      

<h1><a href="../../../"><img src="../../../logo/ljk.png" alt="Boylad" /></a></h1>



      <nav class="menu">
        <input id="menu-check" type="checkbox" />
        <label id="menu-label" for="menu-check" class="unselectable">
          <span class="icon close-icon">✕</span>
          <span class="icon open-icon">☰</span>
          <span class="text">Menu</span>
        </label>
        <ul>
        
        
        <li><a href="../../../">首页</a></li>
        
        <li><a href="../../../cn/about/">关于</a></li>
        
        <li><a href="../../../cn/post/">博客</a></li>
        
        <li><a href="../../../en/">English</a></li>
        
        

<li class="menu-extra"></li>


<li><a href="../../../cn/index.xml" type="application/rss+xml" title="RSS feed">订阅</a></li>

<li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Attribution-NonCommercial-ShareAlike 4.0 International">版权</a></li>


        </ul>
      </nav>
    </header>

    <article class="main">
      <header class="title">
        

<h1>R基础知识（二）</h1>



<h3>Boylad &middot 
2018-12-03</h3> 


   
  


      </header>





<div id="基础操作" class="section level3">
<h3><strong>基础操作</strong></h3>
<pre class="r"><code>#把1,2,...,100这个整数向量赋值到X
X &lt;- 1:100 
#同上，只不过显示出来
(X &lt;- 1:100) 
##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
##  [91]  91  92  93  94  95  96  97  98  99 100
#从把1,2,...,100中随机不放回地抽取20个值作为样本
sample(X, 20) 
##  [1] 33 67 45 85 65 14  2 99 24 97 46 68 52 61 25 76 87 10 39 64
#先设置随机种子再抽样
set.seed(0)
sample(1:10, 3)
## [1] 9 4 7
#从1,2,...,2000000中随机不放回地抽取10000个值作为样本
Z &lt;- sample(1:200000, 10000)
#方括号中为向量Z的下标
Z[1:10]
##  [1]  13218  61911 172302  79035 176097  50453 112566  90442 192329 173781
#以y为下标的Z的元素值
y &lt;- c(1, 3, 7, 3, 4, 2)
Z[y]
## [1]  13218 172302 112566 172302  79035  61911
#从X有放回地随机抽取100个值作为样本
(Z &lt;- sample(X, 100, rep = T))
##   [1] 38 18 60 40  6 49 47 38 71 21 13 95 95 39 78 27 97 15 80 63 53 68 17 78 54
##  [26] 93 81 16  8 69 60 16 64 40  5 58 32 65 91 93 99 66 63  7 36 12 79 94 78 80
##  [51] 31 81 48 32 25 12  8 19 26 48 58 57 82 66 26 74 54 27 16 93 49 29  2 20 11
##  [76] 75 38 99 30 42 80 92 41 19 57 27 72 30 48 86  5 44 74 16 99 14 56 82 70 31
#无重复地显示Z中的元素(显示Z中不同元素)
(Z1 &lt;- unique(Z))
##  [1] 38 18 60 40  6 49 47 71 21 13 95 39 78 27 97 15 80 63 53 68 17 54 93 81 16
## [26]  8 69 64  5 58 32 65 91 99 66  7 36 12 79 94 31 48 25 19 26 57 82 74 29  2
## [51] 20 11 75 30 42 92 41 72 86 44 14 56 70
#Z中不同元素的个数
length(Z1)
## [1] 63
#X个Z之间的不同元素——集合差
XZ &lt;- setdiff(X, Z)
#对XZ及Z的并集的元素从小到大排序
sort(union(XZ, Z))
##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
##  [91]  91  92  93  94  95  96  97  98  99 100
#XZ及Z的并的元素与X是否一样
setequal(union(XZ, X), X)
## [1] TRUE
#两个数据的交
intersect(1:10, 7:50)
## [1]  7  8  9 10
#从1:100中不等概率随机抽样(各数字被抽到的概率与其值大小成比例)
sample(1:100, 20, prob = 1:100)
##  [1] 97 86 51 77 58 47 25 85 18 82 53 88 60 52 95 89 81 30 92 21</code></pre>
<p><br></p>
</div>
<div id="一些简单运算" class="section level3">
<h3><strong>一些简单运算</strong></h3>
<pre class="r"><code>#pi是圆周率
pi*10^2
## [1] 314.1593
#可以对向量求指数幂
pi*(1:10)^-2.3
##  [1] 3.14159265 0.63794154 0.25105622 0.12954239 0.07753876 0.05098025
##  [7] 0.03576221 0.02630528 0.02006283 0.01574526
#和上面一样
X = pi * 10^2 
X
## [1] 314.1593
print(X)
## [1] 314.1593
#赋值带打印
(X &lt;- pi * 10^2)
## [1] 314.1593
#指数也可以是向量
pi^(1:5)
## [1]   3.141593   9.869604  31.006277  97.409091 306.019685
#输出X的12位数字
print(X, digits = 12)
## [1] 314.159265359</code></pre>
<p><br></p>
</div>
<div id="关于r对象的类型" class="section level3">
<h3><strong>关于R对象的类型</strong></h3>
<pre class="r"><code>X &lt;- pi * 10^2
class(X) #X的class
## [1] &quot;numeric&quot;
typeof(X) #X的type
## [1] &quot;double&quot;
class(cars) #cars是一个R中自带的数据
## [1] &quot;data.frame&quot;
typeof(cars) #cars的type
## [1] &quot;list&quot;
names(cars) #cars数据的变量名字
## [1] &quot;speed&quot; &quot;dist&quot;
summary(cars) #cars的汇总
##      speed           dist       
##  Min.   : 4.0   Min.   :  2.00  
##  1st Qu.:12.0   1st Qu.: 26.00  
##  Median :15.0   Median : 36.00  
##  Mean   :15.4   Mean   : 42.98  
##  3rd Qu.:19.0   3rd Qu.: 56.00  
##  Max.   :25.0   Max.   :120.00
head(cars) #cars的头几行数据，和cars[1:6,]相同
##   speed dist
## 1     4    2
## 2     4   10
## 3     7    4
## 4     7   22
## 5     8   16
## 6     9   10
tail(cars) #cars的最后几行数据
##    speed dist
## 45    23   54
## 46    24   70
## 47    24   92
## 48    24   93
## 49    24  120
## 50    25   85
str(cars) #也是汇总
## &#39;data.frame&#39;:    50 obs. of  2 variables:
##  $ speed: num  4 4 7 7 8 9 10 10 10 11 ...
##  $ dist : num  2 10 4 22 16 10 18 26 34 17 ...
row.names(cars) #行名字
##  [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot; &quot;11&quot; &quot;12&quot; &quot;13&quot; &quot;14&quot; &quot;15&quot;
## [16] &quot;16&quot; &quot;17&quot; &quot;18&quot; &quot;19&quot; &quot;20&quot; &quot;21&quot; &quot;22&quot; &quot;23&quot; &quot;24&quot; &quot;25&quot; &quot;26&quot; &quot;27&quot; &quot;28&quot; &quot;29&quot; &quot;30&quot;
## [31] &quot;31&quot; &quot;32&quot; &quot;33&quot; &quot;34&quot; &quot;35&quot; &quot;36&quot; &quot;37&quot; &quot;38&quot; &quot;39&quot; &quot;40&quot; &quot;41&quot; &quot;42&quot; &quot;43&quot; &quot;44&quot; &quot;45&quot;
## [46] &quot;46&quot; &quot;47&quot; &quot;48&quot; &quot;49&quot; &quot;50&quot;
attributes(cars) #cars的一些信息
## $names
## [1] &quot;speed&quot; &quot;dist&quot; 
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
## [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
class(dist ~ speed) #公式形式，&quot;~&quot;左边是因变量，右边是自变量
## [1] &quot;formula&quot;
plot(dist~speed, cars) #两个变量的散点图</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(cars$speed, cars$dist) #同上</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-3-2.png" width="672" style="display: block; margin: auto;" />
<br></p>
</div>
<div id="简单自变量为定量变量及定性变量的回归" class="section level3">
<h3><strong>简单自变量为定量变量及定性变量的回归</strong></h3>
<pre class="r"><code>#cars的行列数
ncol(cars)
## [1] 2
nrow(cars)
## [1] 50
#以dist为因变量，speed为自变量做OLS
lm(dist ~ speed, data = cars)
## 
## Call:
## lm(formula = dist ~ speed, data = cars)
## 
## Coefficients:
## (Intercept)        speed  
##     -17.579        3.932
#增加定性变量qspeed,四分位点为分割点
cars$qspeed &lt;- cut(cars$speed, breaks = quantile(cars$speed),
                   include.lowest = TRUE)
names(cars) #数据cars多了一个变量
## [1] &quot;speed&quot;  &quot;dist&quot;   &quot;qspeed&quot;
head(cars[3]) #第三个变量前6行的值，和cars[,3]类似
##   qspeed
## 1 [4,12]
## 2 [4,12]
## 3 [4,12]
## 4 [4,12]
## 5 [4,12]
## 6 [4,12]
table(cars[3]) #列表
## 
##  [4,12] (12,15] (15,19] (19,25] 
##      15      11      12      12
is.factor(cars$qspeed) #是否为列表
## [1] TRUE
plot(dist ~ qspeed, data = cars) #箱线图</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#拟合线性模型(简单最小二乘回归)：
(a &lt;- lm(dist ~ qspeed, data = cars))
## 
## Call:
## lm(formula = dist ~ qspeed, data = cars)
## 
## Coefficients:
##   (Intercept)  qspeed(12,15]  qspeed(15,19]  qspeed(19,25]  
##         18.20          21.98          31.97          51.13
#回归结果(包括一些检验)
summary(a)
## 
## Call:
## lm(formula = dist ~ qspeed, data = cars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -37.33 -13.96  -3.75   9.30  50.67 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     18.200      4.551   3.999 0.000228 ***
## qspeed(12,15]   21.982      6.996   3.142 0.002933 ** 
## qspeed(15,19]   31.967      6.826   4.683 2.52e-05 ***
## qspeed(19,25]   51.133      6.826   7.491 1.68e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 17.62 on 46 degrees of freedom
## Multiple R-squared:  0.5609, Adjusted R-squared:  0.5322 
## F-statistic: 19.59 on 3 and 46 DF,  p-value: 2.517e-08</code></pre>
<p><br></p>
</div>
<div id="简单样本描述统计量" class="section level3">
<h3><strong>简单样本描述统计量</strong></h3>
<pre class="r"><code>X &lt;- round(runif(20, 0, 20), digits = 2) #四舍五入
summary(X) #汇总
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.370   4.730   8.905   9.379  13.760  18.890
#极值，与range(X)类似
min(X)
## [1] 0.37
max(X)
## [1] 18.89
median(X) #中位数(median)
## [1] 8.905
mean(X) #均值(mean)
## [1] 9.379
var(X) #方差(variance)
## [1] 34.54842
sd(X) #标准差(standard deviation)
## [1] 5.87779
sqrt(X) #平方根
##  [1] 3.4756294 3.4597688 2.1771541 3.6221541 1.8110770 1.2529964 2.9274562
##  [8] 3.8871583 0.6082763 2.7037012 3.0397368 2.3979158 1.2288206 4.3462628
## [15] 3.6482873 4.0792156 4.3150898 3.9025633 2.3600847 2.1679483
rank(X) #秩(rank)
##  [1] 13 12  6 14  4  3 10 16  1  9 11  8  2 20 15 18 19 17  7  5
order(X) #升幂排列的X的下标
##  [1]  9 13  6  5 20  3 19 12 10  7 11  2  1  4 15  8 18 16 17 14
order(X, decreasing = TRUE) #降幂排列的X的下标
##  [1] 14 17 16 18  8 15  4  1  2 11  7 10 12 19  3 20  5  6 13  9
X[order(X)] #和sort(X)相同
##  [1]  0.37  1.51  1.57  3.28  4.70  4.74  5.57  5.75  7.31  8.57  9.24 11.97
## [13] 12.08 13.12 13.31 15.11 15.23 16.64 18.62 18.89
sort(X) #同上：升幂排列的X
##  [1]  0.37  1.51  1.57  3.28  4.70  4.74  5.57  5.75  7.31  8.57  9.24 11.97
## [13] 12.08 13.12 13.31 15.11 15.23 16.64 18.62 18.89
sort(X, decreasing = TRUE) #sort(X, dec = TRUE) 降幂排列的X
##  [1] 18.89 18.62 16.64 15.23 15.11 13.31 13.12 12.08 11.97  9.24  8.57  7.31
## [13]  5.75  5.57  4.74  4.70  3.28  1.57  1.51  0.37
sum(X) #元素和
## [1] 187.58
length(X) #向量元素个数
## [1] 20
round(X) #四舍五入，等于round(X, 0),而round(X, 5)保留到小数点后5位
##  [1] 12 12  5 13  3  2  9 15  0  7  9  6  2 19 13 17 19 15  6  5
fivenum(X) #五数汇总，quantile，等同于summary(X)
## [1]  0.370  4.720  8.905 14.210 18.890
quantile(X) #分为点 quantile(different convention)有多种定义
##     0%    25%    50%    75%   100% 
##  0.370  4.730  8.905 13.760 18.890
quantile(X, c(0, .33, .66, 1))
##      0%     33%     66%    100% 
##  0.3700  5.6186 12.6416 18.8900
mad(X) #&quot;median average diatance&quot;
## [1] 6.390006
cummax(X) #累积最大值
##  [1] 12.08 12.08 12.08 13.12 13.12 13.12 13.12 15.11 15.11 15.11 15.11 15.11
## [13] 15.11 18.89 18.89 18.89 18.89 18.89 18.89 18.89
cummin(X) #累积最小值
##  [1] 12.08 11.97  4.74  4.74  3.28  1.57  1.57  1.57  0.37  0.37  0.37  0.37
## [13]  0.37  0.37  0.37  0.37  0.37  0.37  0.37  0.37
cumprod(X) #累积积
##  [1] 1.208000e+01 1.445976e+02 6.853926e+02 8.992351e+03 2.949491e+04
##  [6] 4.630701e+04 3.968511e+05 5.996420e+06 2.218675e+06 1.621852e+07
## [11] 1.498591e+08 8.616898e+08 1.301152e+09 2.457875e+10 3.271432e+11
## [16] 5.443663e+12 1.013610e+14 1.543728e+15 8.598566e+15 4.041326e+16
cor(X, sin(X/20)) #线性相关系数(correlation)
## [1] 0.9977729</code></pre>
<p><br></p>
</div>
<div id="简单图形" class="section level3">
<h3><strong>简单图形</strong></h3>
<pre class="r"><code>X &lt;- rnorm(200)
hist(X, col = &quot;lightblue&quot;) #直方图
rug(X) #在直方图下面加上是实际点的大小</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>stem(X) #茎叶图
## 
##   The decimal point is at the |
## 
##   -2 | 5
##   -2 | 10
##   -1 | 99987665555
##   -1 | 4322210000000
##   -0 | 9999998888888777777777666666666555555
##   -0 | 444444333322222222221111111111000
##    0 | 00000111111111111122223333334444444444
##    0 | 55555566666677777778888888999
##    1 | 000001122233334
##    1 | 55567777889999
##    2 | 000122
##    2 | 6
X &lt;- rnorm(500)
Y &lt;- X + rnorm(500) #构造一个线性关系
plot(Y ~ X) #散点图
a &lt;- lm(Y ~ X) #做回归
abline(a, col = &quot;red&quot;) #或者abline(lm(Y ~Ｘ), col = &quot;red&quot;)散点图加拟合线</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>print(&quot;Hello World!&quot;)
## [1] &quot;Hello World!&quot;
paste(&quot;X 的最小值=&quot;, min(X)) #打印
## [1] &quot;X 的最小值= -3.19493429349719&quot;
demo(graphics) #演示画图(点击Enter来切换)
## 
## 
##  demo(graphics)
##  ---- ~~~~~~~~
## 
## &gt; #  Copyright (C) 1997-2009 The R Core Team
## &gt; 
## &gt; require(datasets)
## 
## &gt; require(grDevices); require(graphics)
## 
## &gt; ## Here is some code which illustrates some of the differences between
## &gt; ## R and S graphics capabilities.  Note that colors are generally specified
## &gt; ## by a character string name (taken from the X11 rgb.txt file) and that line
## &gt; ## textures are given similarly.  The parameter &quot;bg&quot; sets the background
## &gt; ## parameter for the plot and there is also an &quot;fg&quot; parameter which sets
## &gt; ## the foreground color.
## &gt; 
## &gt; 
## &gt; x &lt;- stats::rnorm(50)
## 
## &gt; opar &lt;- par(bg = &quot;white&quot;)
## 
## &gt; plot(x, ann = FALSE, type = &quot;n&quot;)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; abline(h = 0, col = gray(.90))
## 
## &gt; lines(x, col = &quot;green4&quot;, lty = &quot;dotted&quot;)
## 
## &gt; points(x, bg = &quot;limegreen&quot;, pch = 21)
## 
## &gt; title(main = &quot;Simple Use of Color In a Plot&quot;,
## +       xlab = &quot;Just a Whisper of a Label&quot;,
## +       col.main = &quot;blue&quot;, col.lab = gray(.8),
## +       cex.main = 1.2, cex.lab = 1.0, font.main = 4, font.lab = 3)
## 
## &gt; ## A little color wheel.    This code just plots equally spaced hues in
## &gt; ## a pie chart.    If you have a cheap SVGA monitor (like me) you will
## &gt; ## probably find that numerically equispaced does not mean visually
## &gt; ## equispaced.  On my display at home, these colors tend to cluster at
## &gt; ## the RGB primaries.  On the other hand on the SGI Indy at work the
## &gt; ## effect is near perfect.
## &gt; 
## &gt; par(bg = &quot;gray&quot;)
## 
## &gt; pie(rep(1,24), col = rainbow(24), radius = 0.9)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; title(main = &quot;A Sample Color Wheel&quot;, cex.main = 1.4, font.main = 3)
## 
## &gt; title(xlab = &quot;(Use this as a test of monitor linearity)&quot;,
## +       cex.lab = 0.8, font.lab = 3)
## 
## &gt; ## We have already confessed to having these.  This is just showing off X11
## &gt; ## color names (and the example (from the postscript manual) is pretty &quot;cute&quot;.
## &gt; 
## &gt; pie.sales &lt;- c(0.12, 0.3, 0.26, 0.16, 0.04, 0.12)
## 
## &gt; names(pie.sales) &lt;- c(&quot;Blueberry&quot;, &quot;Cherry&quot;,
## +              &quot;Apple&quot;, &quot;Boston Cream&quot;, &quot;Other&quot;, &quot;Vanilla Cream&quot;)
## 
## &gt; pie(pie.sales,
## +     col = c(&quot;purple&quot;,&quot;violetred1&quot;,&quot;green3&quot;,&quot;cornsilk&quot;,&quot;cyan&quot;,&quot;white&quot;))</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; title(main = &quot;January Pie Sales&quot;, cex.main = 1.8, font.main = 1)
## 
## &gt; title(xlab = &quot;(Don&#39;t try this at home kids)&quot;, cex.lab = 0.8, font.lab = 3)
## 
## &gt; ## Boxplots:  I couldn&#39;t resist the capability for filling the &quot;box&quot;.
## &gt; ## The use of color seems like a useful addition, it focuses attention
## &gt; ## on the central bulk of the data.
## &gt; 
## &gt; par(bg=&quot;cornsilk&quot;)
## 
## &gt; n &lt;- 10
## 
## &gt; g &lt;- gl(n, 100, n*100)
## 
## &gt; x &lt;- rnorm(n*100) + sqrt(as.numeric(g))
## 
## &gt; boxplot(split(x,g), col=&quot;lavender&quot;, notch=TRUE)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; title(main=&quot;Notched Boxplots&quot;, xlab=&quot;Group&quot;, font.main=4, font.lab=1)
## 
## &gt; ## An example showing how to fill between curves.
## &gt; 
## &gt; par(bg=&quot;white&quot;)
## 
## &gt; n &lt;- 100
## 
## &gt; x &lt;- c(0,cumsum(rnorm(n)))
## 
## &gt; y &lt;- c(0,cumsum(rnorm(n)))
## 
## &gt; xx &lt;- c(0:n, n:0)
## 
## &gt; yy &lt;- c(x, rev(y))
## 
## &gt; plot(xx, yy, type=&quot;n&quot;, xlab=&quot;Time&quot;, ylab=&quot;Distance&quot;)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; polygon(xx, yy, col=&quot;gray&quot;)
## 
## &gt; title(&quot;Distance Between Brownian Motions&quot;)
## 
## &gt; ## Colored plot margins, axis labels and titles.    You do need to be
## &gt; ## careful with these kinds of effects.    It&#39;s easy to go completely
## &gt; ## over the top and you can end up with your lunch all over the keyboard.
## &gt; ## On the other hand, my market research clients love it.
## &gt; 
## &gt; x &lt;- c(0.00, 0.40, 0.86, 0.85, 0.69, 0.48, 0.54, 1.09, 1.11, 1.73, 2.05, 2.02)
## 
## &gt; par(bg=&quot;lightgray&quot;)
## 
## &gt; plot(x, type=&quot;n&quot;, axes=FALSE, ann=FALSE)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; usr &lt;- par(&quot;usr&quot;)
## 
## &gt; rect(usr[1], usr[3], usr[2], usr[4], col=&quot;cornsilk&quot;, border=&quot;black&quot;)
## 
## &gt; lines(x, col=&quot;blue&quot;)
## 
## &gt; points(x, pch=21, bg=&quot;lightcyan&quot;, cex=1.25)
## 
## &gt; axis(2, col.axis=&quot;blue&quot;, las=1)
## 
## &gt; axis(1, at=1:12, lab=month.abb, col.axis=&quot;blue&quot;)
## 
## &gt; box()
## 
## &gt; title(main= &quot;The Level of Interest in R&quot;, font.main=4, col.main=&quot;red&quot;)
## 
## &gt; title(xlab= &quot;1996&quot;, col.lab=&quot;red&quot;)
## 
## &gt; ## A filled histogram, showing how to change the font used for the
## &gt; ## main title without changing the other annotation.
## &gt; 
## &gt; par(bg=&quot;cornsilk&quot;)
## 
## &gt; x &lt;- rnorm(1000)
## 
## &gt; hist(x, xlim=range(-4, 4, x), col=&quot;lavender&quot;, main=&quot;&quot;)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-9.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; title(main=&quot;1000 Normal Random Variates&quot;, font.main=3)
## 
## &gt; ## A scatterplot matrix
## &gt; ## The good old Iris data (yet again)
## &gt; 
## &gt; pairs(iris[1:4], main=&quot;Edgar Anderson&#39;s Iris Data&quot;, font.main=4, pch=19)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; pairs(iris[1:4], main=&quot;Edgar Anderson&#39;s Iris Data&quot;, pch=21,
## +       bg = c(&quot;red&quot;, &quot;green3&quot;, &quot;blue&quot;)[unclass(iris$Species)])</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-11.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; ## Contour plotting
## &gt; ## This produces a topographic map of one of Auckland&#39;s many volcanic &quot;peaks&quot;.
## &gt; 
## &gt; x &lt;- 10*1:nrow(volcano)
## 
## &gt; y &lt;- 10*1:ncol(volcano)
## 
## &gt; lev &lt;- pretty(range(volcano), 10)
## 
## &gt; par(bg = &quot;lightcyan&quot;)
## 
## &gt; pin &lt;- par(&quot;pin&quot;)
## 
## &gt; xdelta &lt;- diff(range(x))
## 
## &gt; ydelta &lt;- diff(range(y))
## 
## &gt; xscale &lt;- pin[1]/xdelta
## 
## &gt; yscale &lt;- pin[2]/ydelta
## 
## &gt; scale &lt;- min(xscale, yscale)
## 
## &gt; xadd &lt;- 0.5*(pin[1]/scale - xdelta)
## 
## &gt; yadd &lt;- 0.5*(pin[2]/scale - ydelta)
## 
## &gt; plot(numeric(0), numeric(0),
## +      xlim = range(x)+c(-1,1)*xadd, ylim = range(y)+c(-1,1)*yadd,
## +      type = &quot;n&quot;, ann = FALSE)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-12.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; usr &lt;- par(&quot;usr&quot;)
## 
## &gt; rect(usr[1], usr[3], usr[2], usr[4], col=&quot;green3&quot;)
## 
## &gt; contour(x, y, volcano, levels = lev, col=&quot;yellow&quot;, lty=&quot;solid&quot;, add=TRUE)
## 
## &gt; box()
## 
## &gt; title(&quot;A Topographic Map of Maunga Whau&quot;, font= 4)
## 
## &gt; title(xlab = &quot;Meters North&quot;, ylab = &quot;Meters West&quot;, font= 3)
## 
## &gt; mtext(&quot;10 Meter Contour Spacing&quot;, side=3, line=0.35, outer=FALSE,
## +       at = mean(par(&quot;usr&quot;)[1:2]), cex=0.7, font=3)
## 
## &gt; ## Conditioning plots
## &gt; 
## &gt; par(bg=&quot;cornsilk&quot;)
## 
## &gt; coplot(lat ~ long | depth, data = quakes, pch = 21, bg = &quot;green3&quot;)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-6-13.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## &gt; par(opar)</code></pre>
<p><br></p>
</div>
<div id="复数运算和求函数极值" class="section level3">
<h3><strong>复数运算和求函数极值</strong></h3>
<pre class="r"><code>(2+4i)^-3.5+(2i+4.5)*(-1.7-2.3i)/((2.6-7i)*(-4+5.1i)) #复数运算
## [1] -0.2790593-0.091246i
#下面构造一个10维复向量，实部和虚部均为10个标准正态样本点：
(Z &lt;- complex(real = rnorm(10), imaginary = rnorm(10)))
##  [1]  1.0496171+0.1844224i  0.2903237+0.4030923i  1.2421262+0.8944587i
##  [4] -0.6850857-0.5303014i -0.6677681-0.1708288i  0.9409138+1.9139498i
##  [7]  0.9953313+0.0000754i  1.0210044-0.4605468i  0.7925958-0.7146372i
## [10] -1.3772293-1.8384693i
complex(re = rnorm(3), im = rnorm(3)) #3维复向量
## [1]  0.1046207+1.2829697i -0.8085439+1.0202919i -0.3638606-0.5302771i
Re(Z) #实部
##  [1]  1.0496171  0.2903237  1.2421262 -0.6850857 -0.6677681  0.9409138
##  [7]  0.9953313  1.0210044  0.7925958 -1.3772293
Im(Z) #虚部
##  [1]  0.1844224002  0.4030922661  0.8944587436 -0.5303014446 -0.1708288145
##  [6]  1.9139497514  0.0000754026 -0.4605467509 -0.7146371890 -1.8384693040
Mod(Z) #模
##  [1] 1.0656959 0.4967608 1.5306646 0.8663498 0.6892726 2.1327265 0.9953313
##  [8] 1.1200684 1.0671994 2.2971134
Arg(Z) #辐角
##  [1]  1.739291e-01  9.466143e-01  6.240908e-01 -2.482866e+00 -2.891143e+00
##  [6]  1.113885e+00  7.575628e-05 -4.237453e-01 -7.337212e-01 -2.213732e+00
choose(3,2) #组合
## [1] 3
factorial(6) #6！
## [1] 720
#解方程
f &lt;- function(x) 
  x^3-2*x-1
uniroot(f, c(0,2)) #迭代求根
## $root
## [1] 1.618018
## 
## $f.root
## [1] -9.17404e-05
## 
## $iter
## [1] 6
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05
#如果知道根为极值
f &lt;- function(x)
  x^2+2*x+1 #定义一个二次函数
optimize(f, c(-2,2)) #在区间(-2,2)内求极值
## $minimum
## [1] -1
## 
## $objective
## [1] 0</code></pre>
<p><br></p>
</div>
<div id="字符向量和因子向量" class="section level3">
<h3><strong>字符向量和因子向量</strong></h3>
<pre class="r"><code>a &lt;- factor(letters[1:10]) #letters:小写字母向量， LETTERS:大写
a
##  [1] a b c d e f g h i j
## Levels: a b c d e f g h i j
a[3] &lt;- &quot;w&quot; #不行！会给出警告
a &lt;- as.factor(a) #转换一下
a[3] &lt;- &quot;w&quot; #可以了
a
##  [1] a    b    &lt;NA&gt; d    e    f    g    h    i    j   
## Levels: a b c d e f g h i j
factor(a)
##  [1] a    b    &lt;NA&gt; d    e    f    g    h    i    j   
## Levels: a b d e f g h i j
#定性变量的水平
levels(factor(a)) 
## [1] &quot;a&quot; &quot;b&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot;
sex &lt;- sample(0:1, 10, r = T)
sex &lt;- factor(sex)
levels(sex)
## [1] &quot;0&quot; &quot;1&quot;
#改变因子的水平
levels(sex) = c(&quot;Male&quot;, &quot;Female&quot;)
levels(sex)
## [1] &quot;Male&quot;   &quot;Female&quot;
#确定水平次序
sex &lt;- ordered(sex, c(&quot;Female&quot;, &quot;Male&quot;))
sex
##  [1] Female Male   Male   Male   Male   Male   Female Male   Male   Male  
## Levels: Female &lt; Male
levels(sex)
## [1] &quot;Female&quot; &quot;Male&quot;</code></pre>
<p><br></p>
</div>
<div id="序列等" class="section level3">
<h3><strong>序列等</strong></h3>
<pre class="r"><code>#从-1到100等间隔的20个数组成的序列
(Z &lt;- seq(-1, 10, length = 20) )
##  [1] -1.0000000 -0.4210526  0.1578947  0.7368421  1.3157895  1.8947368
##  [7]  2.4736842  3.0526316  3.6315789  4.2105263  4.7894737  5.3684211
## [13]  5.9473684  6.5263158  7.1052632  7.6842105  8.2631579  8.8421053
## [19]  9.4210526 10.0000000
Z &lt;- seq(-1, 10, len = 20) #和上面写法等价
(Z &lt;- seq(10, -1, -0.5)) #10到-1间隔为-0.5的序列
##  [1] 10.0  9.5  9.0  8.5  8.0  7.5  7.0  6.5  6.0  5.5  5.0  4.5  4.0  3.5  3.0
## [16]  2.5  2.0  1.5  1.0  0.5  0.0 -0.5 -1.0
(X &lt;- rep(1:3, 3)) #三次重复1:3
## [1] 1 2 3 1 2 3 1 2 3
(X &lt;- rep(3:5, 1:3))
## [1] 3 4 4 5 5 5
X &lt;- rep(c(1,10), c(4,5))
X
## [1]  1  1  1  1 10 10 10 10 10
W &lt;- c(1,3,X,Z) #把数据(包括向量)组合(combine)成一个向量
W[3]
## [1] 1
(X &lt;- rep(0, 10))
##  [1] 0 0 0 0 0 0 0 0 0 0
(Z &lt;- 1:3)
## [1] 1 2 3
(X + Z) #向量加法(如果长度不同，R给出警告和结果)
##  [1] 1 2 3 1 2 3 1 2 3 1
(X * Z) #向量乘法
##  [1] 0 0 0 0 0 0 0 0 0 0
rev(Z) #颠倒次序
## [1] 3 2 1
Z &lt;- c(&quot;no cat&quot;, &quot;has&quot;, &quot;nine&quot;, &quot;tails&quot;) #字符向量
Z[1] == &quot;no cat&quot; #双等号为逻辑等式
## [1] TRUE
Z &lt;- 1:5
Z[7] &lt;- 8 
Z #NA为缺失值(not available)
## [1]  1  2  3  4  5 NA  8
Z &lt;- NULL
Z[c(1,3,5)] &lt;- 1:3
Z
## [1]  1 NA  2 NA  3
rnorm(10)[c(2,5)]
## [1] -1.6936073  0.1201104
(Z[-c(1,3)]) #去掉第1、3元素
## [1] NA NA  3
(Z &lt;- sample(1:100, 10))
##  [1] 16 91 21 77 35 69 47 99 71 27
which(Z==max(Z)) #给出最大值的下标
## [1] 8</code></pre>
<p><br></p>
</div>
<div id="矩阵" class="section level3">
<h3><strong>矩阵</strong></h3>
<pre class="r"><code>(X &lt;- sample(1:100, 12)) #抽样
##  [1] 47 71 29 99 38  6 12 65 33 36 50 63
#逻辑符号的应用
all(X &gt; 0)
## [1] TRUE
all(X != 0)
## [1] TRUE
any(X &gt; 0)
## [1] TRUE
(1:10)[X&gt;0]
##  [1]  1  2  3  4  5  6  7  8  9 10 NA NA
diff(X) #差分
##  [1]  24 -42  70 -61 -32   6  53 -32   3  14  13
diff(X, lag = 2) #差分
##  [1] -18  28   9 -93 -26  59  21 -29  17  27
(X &lt;- matrix(1:20, 4, 5)) #矩阵的构造
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    5    9   13   17
## [2,]    2    6   10   14   18
## [3,]    3    7   11   15   19
## [4,]    4    8   12   16   20
(X &lt;- matrix(1:20, 4, 5)) #矩阵的构造, 按行排列
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    5    9   13   17
## [2,]    2    6   10   14   18
## [3,]    3    7   11   15   19
## [4,]    4    8   12   16   20
t(X) #矩阵转置
##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    5    6    7    8
## [3,]    9   10   11   12
## [4,]   13   14   15   16
## [5,]   17   18   19   20
(X &lt;- matrix(sample(1:100, 20), 4, 5))
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1   99    7   21   65
## [2,]   46   38   91   60   70
## [3,]   14   10   80   32   28
## [4,]   81   37   35   20   24
2*X
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    2  198   14   42  130
## [2,]   92   76  182  120  140
## [3,]   28   20  160   64   56
## [4,]  162   74   70   40   48
X+5
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    6  104   12   26   70
## [2,]   51   43   96   65   75
## [3,]   19   15   85   37   33
## [4,]   86   42   40   25   29
(Y &lt;- matrix(sample(1:100, 20), 5, 4))
##      [,1] [,2] [,3] [,4]
## [1,]    9    4   42   53
## [2,]   45   77   84   11
## [3,]   37   12   49   39
## [4,]   47   34   30   25
## [5,]   20    2   74   14
X + t(Y) #矩阵之间相加
##      [,1] [,2] [,3] [,4] [,5]
## [1,]   10  144   44   68   85
## [2,]   50  115  103   94   72
## [3,]   56   94  129   62  102
## [4,]  134   48   74   45   38
(Z &lt;- X %*% Y) #矩阵乘法
##      [,1] [,2]  [,3] [,4]
## [1,] 7010 8555 14141 2850
## [2,] 9711 6382 16563 8885
## [3,] 5600 2930  8380 5164
## [4,] 5109 4321 10601 6901
Z1 &lt;- solve(Z) #用solve(a,b)可以解ax=b
Z1 %*% Z #应该是单位向量，但浮点运算不可能得到干净的0
##               [,1]          [,2]         [,3]          [,4]
## [1,]  1.000000e+00  1.665335e-15 6.661338e-15  3.996803e-15
## [2,]  2.220446e-15  1.000000e+00 4.440892e-15  4.440892e-15
## [3,] -1.776357e-15 -2.886580e-15 1.000000e+00 -1.332268e-15
## [4,]  0.000000e+00  4.440892e-16 8.881784e-16  1.000000e+00
round(Z1 %*% Z, 0) #四舍五入
##      [,1] [,2] [,3] [,4]
## [1,]    1    0    0    0
## [2,]    0    1    0    0
## [3,]    0    0    1    0
## [4,]    0    0    0    1
b &lt;- solve(Z, 1:4)
b #联立解方程
## [1]  0.002207448  0.005525297 -0.005006431  0.003176426</code></pre>
<p><br></p>
</div>
<div id="矩阵续" class="section level3">
<h3><strong>矩阵(续)</strong></h3>
<pre class="r"><code>#行列数目
nrow(X)
## [1] 4
ncol(X)
## [1] 5
dim(X)
## [1] 4 5
(X &lt;- matrix(rnorm(24), 4, 6))
##            [,1]         [,2]       [,3]      [,4]       [,5]       [,6]
## [1,] -0.6903121  0.594365061  0.1882529 1.8722902 -0.2190501  2.5567747
## [2,]  0.1426123 -0.915443157 -0.3302688 0.2123343  1.2989344 -0.9803302
## [3,]  2.3953355  0.002704707  0.6552713 1.2943698  0.1667661  0.4778879
## [4,] -0.1275299  0.776622965 -0.8263119 1.2411447  0.4227844  0.2003272
X[c(2,1),] #第2和第1行
##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
## [1,]  0.1426123 -0.9154432 -0.3302688 0.2123343  1.2989344 -0.9803302
## [2,] -0.6903121  0.5943651  0.1882529 1.8722902 -0.2190501  2.5567747
X[,c(1,3)] #第1和第3列
##            [,1]       [,2]
## [1,] -0.6903121  0.1882529
## [2,]  0.1426123 -0.3302688
## [3,]  2.3953355  0.6552713
## [4,] -0.1275299 -0.8263119
X[2,1] #第[2,1]元素
## [1] 0.1426123
X[X[,1]&gt;0,1] #第1列大于0的元素
## [1] 0.1426123 2.3953355
sum(X[,1]&gt;0) #第1列大于0的元素个数
## [1] 2
sum(X[,1]&lt;=0) #第1列不大于0的元素个数
## [1] 2
X[,-c(1,3)] #没有第1、3列的X
##              [,1]      [,2]       [,3]       [,4]
## [1,]  0.594365061 1.8722902 -0.2190501  2.5567747
## [2,] -0.915443157 0.2123343  1.2989344 -0.9803302
## [3,]  0.002704707 1.2943698  0.1667661  0.4778879
## [4,]  0.776622965 1.2411447  0.4227844  0.2003272
diag(X) #X的对角线元素
## [1] -0.6903121 -0.9154432  0.6552713  1.2411447
diag(1:5) #以1:5为对角线元素，其他元素为0的对角线矩阵
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    2    0    0    0
## [3,]    0    0    3    0    0
## [4,]    0    0    0    4    0
## [5,]    0    0    0    0    5
diag(5) #5维单位矩阵
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0    0    1    0    0
## [4,]    0    0    0    1    0
## [5,]    0    0    0    0    1
X[-2, -c(1,3)] #没有第2行，第1、3列的X
##             [,1]     [,2]       [,3]      [,4]
## [1,] 0.594365061 1.872290 -0.2190501 2.5567747
## [2,] 0.002704707 1.294370  0.1667661 0.4778879
## [3,] 0.776622965 1.241145  0.4227844 0.2003272
X[X[,1]&gt;0 &amp; X[,3]&lt;=1, 1] #第1列&gt;0并且第3列&lt;=1的第1列元素
## [1] 0.1426123 2.3953355
X[X[,2]&gt;0 | X[,1]&lt;.51, 1] #第1列&lt;.51或者第2列&gt;0的第1列元素
## [1] -0.6903121  0.1426123  2.3953355 -0.1275299
X[!X[,2]&lt;.51, 1] #第1列中相应于第2列&gt;=.51的元素
## [1] -0.6903121 -0.1275299
apply(X, 1, mean) #对行(第一维)求均值
## [1]  0.71705346 -0.09536019  0.83205587  0.28117290
apply(X, 2, sum) #对列(第二维)求和
## [1]  1.7201057  0.4582496 -0.3130565  4.6201390  1.6694348  2.2546596
(X &lt;- matrix(rnorm(24), 4, 6))
##             [,1]       [,2]       [,3]       [,4]       [,5]        [,6]
## [1,] -0.06675607 -1.2987084  1.2825874  1.6722387  0.5489174  0.06786571
## [2,]  0.24324198  0.1092794 -0.5154929 -0.8735746  1.7396045  1.78288913
## [3,]  1.57319641 -1.1091201  0.4918284  1.9421528  1.3577644  0.45403817
## [4,]  0.40785860 -1.2057419  1.0893740 -0.7254902 -1.8211233 -2.32431560
X1 &lt;- X2 &lt;- X
lower.tri(X1) 
##       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]
## [1,] FALSE FALSE FALSE FALSE FALSE FALSE
## [2,]  TRUE FALSE FALSE FALSE FALSE FALSE
## [3,]  TRUE  TRUE FALSE FALSE FALSE FALSE
## [4,]  TRUE  TRUE  TRUE FALSE FALSE FALSE
X1[lower.tri(X1)] &lt;- 0
X1 #得到上三角阵
##             [,1]       [,2]       [,3]       [,4]       [,5]        [,6]
## [1,] -0.06675607 -1.2987084  1.2825874  1.6722387  0.5489174  0.06786571
## [2,]  0.00000000  0.1092794 -0.5154929 -0.8735746  1.7396045  1.78288913
## [3,]  0.00000000  0.0000000  0.4918284  1.9421528  1.3577644  0.45403817
## [4,]  0.00000000  0.0000000  0.0000000 -0.7254902 -1.8211233 -2.32431560
X2[upper.tri(X2)] &lt;- 0
X2
##             [,1]       [,2]      [,3]       [,4] [,5] [,6]
## [1,] -0.06675607  0.0000000 0.0000000  0.0000000    0    0
## [2,]  0.24324198  0.1092794 0.0000000  0.0000000    0    0
## [3,]  1.57319641 -1.1091201 0.4918284  0.0000000    0    0
## [4,]  0.40785860 -1.2057419 1.0893740 -0.7254902    0    0</code></pre>
<p><br></p>
</div>
<div id="高维数组" class="section level3">
<h3><strong>高维数组</strong></h3>
<pre class="r"><code>#用24个服从均匀分布的样本点构造4乘3乘2的三维数组
(X &lt;- array(runif(24), c(4,3,2)))
## , , 1
## 
##            [,1]      [,2]       [,3]
## [1,] 0.74153766 0.1332268 0.27365356
## [2,] 0.06922773 0.7526676 0.75157998
## [3,] 0.21327422 0.7208868 0.08222841
## [4,] 0.58430176 0.9955347 0.86257547
## 
## , , 2
## 
##           [,1]       [,2]      [,3]
## [1,] 0.4761465 0.06642724 0.4095437
## [2,] 0.2058568 0.70209084 0.6055103
## [3,] 0.3929965 0.12949010 0.6723459
## [4,] 0.9663898 0.38497275 0.5219199
is.matrix(X)
## [1] FALSE
dim(X) #得到维数(4,3,2)
## [1] 4 3 2
is.matrix(X[1,,]) #部分三维数组是矩阵
## [1] TRUE
(X &lt;- array(1:24, c(4,3,2)))
## , , 1
## 
##      [,1] [,2] [,3]
## [1,]    1    5    9
## [2,]    2    6   10
## [3,]    3    7   11
## [4,]    4    8   12
## 
## , , 2
## 
##      [,1] [,2] [,3]
## [1,]   13   17   21
## [2,]   14   18   22
## [3,]   15   19   23
## [4,]   16   20   24
X[c(1,3),,]
## , , 1
## 
##      [,1] [,2] [,3]
## [1,]    1    5    9
## [2,]    3    7   11
## 
## , , 2
## 
##      [,1] [,2] [,3]
## [1,]   13   17   21
## [2,]   15   19   23
apply(X, 1, mean) #可以对部分维做求均值运算
## [1] 11 12 13 14
apply(X, 1:2, sum) #可以对部分维做求和运算
##      [,1] [,2] [,3]
## [1,]   14   22   30
## [2,]   16   24   32
## [3,]   18   26   34
## [4,]   20   28   36
apply(X, c(1,3), prod) #可以对部分维做求乘积运算
##      [,1] [,2]
## [1,]   45 4641
## [2,]  120 5544
## [3,]  231 6555
## [4,]  384 7680</code></pre>
<p><br></p>
</div>
<div id="矩阵与向量之间的运算" class="section level3">
<h3><strong>矩阵与向量之间的运算</strong></h3>
<pre class="r"><code>(X &lt;- matrix(1:20, 5, 4)) #5乘4矩阵
##      [,1] [,2] [,3] [,4]
## [1,]    1    6   11   16
## [2,]    2    7   12   17
## [3,]    3    8   13   18
## [4,]    4    9   14   19
## [5,]    5   10   15   20
sweep(X, 1, 1:5, &quot;*&quot;) #把1:5的每个元素乘到每一行
##      [,1] [,2] [,3] [,4]
## [1,]    1    6   11   16
## [2,]    4   14   24   34
## [3,]    9   24   39   54
## [4,]   16   36   56   76
## [5,]   25   50   75  100
sweep(X, 2, 1:4, &quot;+&quot;) #把1:4的每个元素加到每一列
##      [,1] [,2] [,3] [,4]
## [1,]    2    8   14   20
## [2,]    3    9   15   21
## [3,]    4   10   16   22
## [4,]    5   11   17   23
## [5,]    6   12   18   24
X*1:5
##      [,1] [,2] [,3] [,4]
## [1,]    1    6   11   16
## [2,]    4   14   24   34
## [3,]    9   24   39   54
## [4,]   16   36   56   76
## [5,]   25   50   75  100
#下面把X标准化，即每一元素减去该列均值，除以该列标准差
(X &lt;- matrix(sample(1:100, 24), 6, 4))
##      [,1] [,2] [,3] [,4]
## [1,]   19    3   57   51
## [2,]   40   89   82   32
## [3,]   69   30   48   58
## [4,]    2   27   45   61
## [5,]   49   86   15   72
## [6,]   65   81   55   59
(X1 &lt;- scale(X))
##             [,1]       [,2]       [,3]       [,4]
## [1,] -0.82731758 -1.3395728  0.3074232 -0.3366280
## [2,] -0.02545593  0.9799559  1.4602602 -1.7579462
## [3,]  1.08187684 -0.6113486 -0.1075981  0.1870156
## [4,] -1.47644368 -0.6922624 -0.2459386  0.4114342
## [5,]  0.31819907  0.8990421 -1.6293430  1.2343027
## [6,]  0.92914128  0.7641858  0.2151962  0.2618218
## attr(,&quot;scaled:center&quot;)
## [1] 40.66667 52.66667 50.33333 55.50000
## attr(,&quot;scaled:scale&quot;)
## [1] 26.18906 37.07650 21.68563 13.36787
(X2 &lt;- scale(X, scale = FALSE))
##             [,1]      [,2]       [,3]  [,4]
## [1,] -21.6666667 -49.66667   6.666667  -4.5
## [2,]  -0.6666667  36.33333  31.666667 -23.5
## [3,]  28.3333333 -22.66667  -2.333333   2.5
## [4,] -38.6666667 -25.66667  -5.333333   5.5
## [5,]   8.3333333  33.33333 -35.333333  16.5
## [6,]  24.3333333  28.33333   4.666667   3.5
## attr(,&quot;scaled:center&quot;)
## [1] 40.66667 52.66667 50.33333 55.50000
(X3 &lt;- scale(X, center = FALSE))
##            [,1]       [,2]      [,3]      [,4]
## [1,] 0.36767613 0.04374461 0.9620476 0.8192837
## [2,] 0.77405502 1.29775671 1.3839983 0.5140604
## [3,] 1.33524491 0.43744608 0.8101453 0.9317344
## [4,] 0.03870275 0.39370147 0.7595112 0.9799276
## [5,] 0.94821740 1.25401210 0.2531704 1.1566358
## [6,] 1.25783941 1.18110442 0.9282915 0.9477988
## attr(,&quot;scaled:scale&quot;)
## [1] 51.67591 68.57988 59.24863 62.24950
round(apply(X1, 2, mean), 14)
## [1] 0 0 0 0
apply(X1, 2, sd)
## [1] 1 1 1 1
round(apply(X2, 2, mean), 14)
## [1] 0 0 0 0
apply(X2, 2, sd)
## [1] 26.18906 37.07650 21.68563 13.36787
round(apply(X3, 2, mean), 14)
## [1] 0.7869559 0.7679609 0.8495274 0.8915735
apply(X3, 2, sd)
## [1] 0.5067943 0.5406323 0.3660107 0.2147467</code></pre>
<p><br></p>
</div>
<div id="缺失值数据的合并" class="section level3">
<h3><strong>缺失值，数据的合并</strong></h3>
<pre class="r"><code>head(airquality) #有缺失值(NA)的R自带数据(显示前6行)
##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 5    NA      NA 14.3   56     5   5
## 6    28      NA 14.9   66     5   6
complete.cases(airquality) #判断每行有没有缺失值
##   [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE
##  [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [25] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
##  [37] FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE
##  [49]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [61] FALSE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
##  [73]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
##  [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
##  [97] FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
## [109]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
## [121]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [133]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [145]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
which(complete.cases(airquality) == F) #有缺失值的行号
##  [1]   5   6  10  11  25  26  27  32  33  34  35  36  37  39  42  43  45  46  52
## [20]  53  54  55  56  57  58  59  60  61  65  72  75  83  84  96  97  98 102 103
## [39] 107 115 119 150
sum(complete.cases(airquality)) #完整观测值的个数
## [1] 111
head(na.omit(airquality)) #删去缺失值的数据(显示前6行)
##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 7    23     299  8.6   65     5   7
## 8    19      99 13.8   59     5   8
#附加，横或竖合并数据：append，cbind, rbind
X &lt;- 1:10
X[12] &lt;- 3
(X1 &lt;- append(X, 77, after = 5))
##  [1]  1  2  3  4  5 77  6  7  8  9 10 NA  3
cbind(1:5, rnorm(5))
##      [,1]        [,2]
## [1,]    1  1.12457595
## [2,]    2  0.06073521
## [3,]    3 -0.71389299
## [4,]    4  0.95070305
## [5,]    5 -1.87869262
rbind(1:5, rnorm(5))
##            [,1]       [,2]     [,3]      [,4]      [,5]
## [1,]  1.0000000  2.0000000 3.000000 4.0000000  5.000000
## [2,] -0.1729418 -0.2830812 1.667194 0.1158476 -1.773485
(X &lt;- rbind(1:5, runif(5), runif(5), 1:5, 7:11))
##           [,1]      [,2]     [,3]       [,4]       [,5]
## [1,] 1.0000000 2.0000000 3.000000  4.0000000  5.0000000
## [2,] 0.6720975 0.7062353 0.238977  0.4959569  0.7915186
## [3,] 0.8780203 0.9109981 0.178308  0.2643037  0.2522314
## [4,] 1.0000000 2.0000000 3.000000  4.0000000  5.0000000
## [5,] 7.0000000 8.0000000 9.000000 10.0000000 11.0000000
X[!duplicated(X),]
##           [,1]      [,2]     [,3]       [,4]       [,5]
## [1,] 1.0000000 2.0000000 3.000000  4.0000000  5.0000000
## [2,] 0.6720975 0.7062353 0.238977  0.4959569  0.7915186
## [3,] 0.8780203 0.9109981 0.178308  0.2643037  0.2522314
## [4,] 7.0000000 8.0000000 9.000000 10.0000000 11.0000000
unique(X)
##           [,1]      [,2]     [,3]       [,4]       [,5]
## [1,] 1.0000000 2.0000000 3.000000  4.0000000  5.0000000
## [2,] 0.6720975 0.7062353 0.238977  0.4959569  0.7915186
## [3,] 0.8780203 0.9109981 0.178308  0.2643037  0.2522314
## [4,] 7.0000000 8.0000000 9.000000 10.0000000 11.0000000</code></pre>
<p><br></p>
</div>
<div id="list" class="section level3">
<h3><strong>list</strong></h3>
<pre class="r"><code>#list可以是任何对象（包括list本身）的集合
Z &lt;- list(1:3, Tom &lt;- c(1:2, a &lt;- list(&quot;R&quot;, letters[1:5]), W = &quot;hi&quot;))
Z[[1]]
## [1] 1 2 3
Z[[2]]
## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [1] &quot;R&quot;
## 
## [[4]]
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;
## 
## $W
## [1] &quot;hi&quot;</code></pre>
<p><br></p>
</div>
<div id="条形图和表" class="section level3">
<h3><strong>条形图和表</strong></h3>
<pre class="r"><code>X &lt;- c(3,3,3,4,1,4,2,1,3,2,5,3,1,2,5,2,3,4,2,2,5,3,1,4,2,2,4,3,5,2)
barplot(X) #不合题意的图</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>table(X) #制表
## X
## 1 2 3 4 5 
## 4 9 8 5 4
barplot(table(X)) #正确的图</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-16-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(table(X)/length(X)) #比例图(和上图形状一样)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-16-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>table(X)/length(X)
## X
##         1         2         3         4         5 
## 0.1333333 0.3000000 0.2666667 0.1666667 0.1333333</code></pre>
<p><br></p>
</div>
<div id="形成表格" class="section level3">
<h3><strong>形成表格</strong></h3>
<pre class="r"><code>library(MASS) 
head(quine) #MASS所带数据，显示前6行
##   Eth Sex Age Lrn Days
## 1   A   M  F0  SL    2
## 2   A   M  F0  SL   11
## 3   A   M  F0  SL   14
## 4   A   M  F0  AL    5
## 5   A   M  F0  AL    5
## 6   A   M  F0  AL   13
attach(quine)
#下面的语句产生从该数据得到的各种表格
table(Age)
## Age
## F0 F1 F2 F3 
## 27 46 40 33
table(Sex, Age)
##    Age
## Sex F0 F1 F2 F3
##   F 10 32 19 19
##   M 17 14 21 14
tab &lt;- xtabs(~ Sex + Age, quine)
unclass(tab)
##    Age
## Sex F0 F1 F2 F3
##   F 10 32 19 19
##   M 17 14 21 14
## attr(,&quot;call&quot;)
## xtabs(formula = ~Sex + Age, data = quine)
tapply(Days, Age, mean)
##       F0       F1       F2       F3 
## 14.85185 11.15217 21.05000 19.60606
tapply(Days, list(Sex, Age), mean)
##         F0       F1       F2       F3
## F 18.70000 12.96875 18.42105 14.00000
## M 12.58824  7.00000 23.42857 27.21429
detach(quine) #attach的逆运行</code></pre>
<p><br></p>
</div>
<div id="如何写函数" class="section level3">
<h3><strong>如何写函数</strong></h3>
<pre class="r"><code>#下面这个函数是按照定义(编程简单，但效率不高)求n以内的素数。
ss &lt;- function(n = 100){
  Z = 2
  for (i in 2:n)
    if (any(i%%2:(i-1) == 0) == F)
      Z &lt;- c(Z, i)
    return(Z)
}
##fix(ss) #用来修改任何函数或编写一个新函数
ss() #计算100以内的素数
##  [1]  2  3  5  7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97
t1 &lt;- Sys.time() #记录时间点
tail(ss(10000)) #计算10000以内的素数(这里只显示后6个)
## [1] 9929 9931 9941 9949 9967 9973
Sys.time() - t1 #计算费了多少时间
## Time difference of 0.386966 secs
system.time(ss(10000)) #计算执行ss(10000)所用时间
## 用户 系统 流逝 
## 0.36 0.02 0.37
#函数可以不写return，这时最后一个值为return的值
#为了输出多个值最好使用list输出</code></pre>
<p><br></p>
</div>
<div id="画图" class="section level3">
<h3><strong>画图</strong></h3>
<pre class="r"><code>X &lt;- seq(-3, 3, len = 20)
Y &lt;- dnorm(X) #产生数据
W &lt;- data.frame(X, Y) #合并X,Y成为数据W
par(mfcol = c(2,2)) #准备画四个图的地方
plot(Y ~ X, W, main = &quot;正态密度函数&quot;)
plot(Y ~ X, W, type = &quot;l&quot;, main = &quot;正态密度函数&quot;)
plot(Y ~ X, W, type = &quot;o&quot;, main = &quot;正态密度函数&quot;)
plot(Y ~ X, W, type = &quot;b&quot;, main = &quot;正态密度函数&quot;)</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>par(mfcol = c(1,1)) #取消par(mfcol = c(2,2))</code></pre>
<p><br></p>
</div>
<div id="色彩和符号等的调整" class="section level3">
<h3><strong>色彩和符号等的调整</strong></h3>
<pre class="r"><code>plot(1,1, xlim =c(1, 7.5), ylim = c(0, 5), type = &quot;h&quot;) #画出框架
#在plot命令后面追加点(如要追加线可用lines函数)：
points(1:7, rep(4.5, 7), cex = seq(1, 4, l = 7), col = 1:7, pch = 0:6)
text(1:7, rep(3.5, 7), labels = paste(0:6, letters[1:7]),
     cex = seq(1, 4, l = 7), col = 1:7) #在指定位置加文字
points(1:7, rep(2, 7), pch = (0:6) + 7) #点出符号7到13
text((1:7) + 0.25, rep(2,7), paste((0:6) + 7)) #加符号号码
points(1:7, rep(1, 7), pch = (0:6) + 14) #点出符号14到20
text((1:7) + 0.25, rep(1,7), paste((0:6) + 14)) #加符号号码</code></pre>
<p><img src="../../../cn/post/2018-12-03-r基础知识-二_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#关于符号形状、大小、颜色以及其他画图选项的说明可以用&quot;?par&quot;来查看</code></pre>
<p><br></p>
<p><code>以上内容整理自吴喜之《复杂数据统计方法——基于R的应用》</code></p>
</div>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="../../../cn/post/r%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E4%B8%80/">R基础知识（一）</a></span>
  <span class="nav-next"><a href="../../../cn/post/r%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97arima%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B/">R时间序列ARIMA模型预测</a> &rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/cn\/post\/r%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E4%B8%80\/';
    
  } else if (e.which == 39) {  
    
    url = '\/cn\/post\/r%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97arima%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B\/';
    
  }
  if (url) window.location = url;
});
</script>



<section class="comments">
  <div id="disqus_thread"></div>
  <script src="../../../js/disqusloader.min.js"></script>
  <script>
  var disqus_config = function () {
  
    this.page.url = "https:\/\/Boylad.github.io" + location.pathname;
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//home-xjdzylqrzp.disqus.com/embed.js';
    
    if (location.hash.match(/^#comment/)) {
      var d = document, s = d.createElement('script');
      s.src = disqus_js; s.async = true;
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    } else {
      disqusLoader('#disqus_thread', {
        scriptUrl: disqus_js, laziness: 0, disqusConfig: disqus_config
      });
    }
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>




<script async src="../../../js/fix-toc.js"></script>

<script async src="../../../js/center-img.js"></script>

<script async src="../../../js/right-quote.js"></script>

<script async src="../../../js/no-highlight.js"></script>

<script async src="../../../js/fix-footnote.js"></script>

<script async src="../../../js/math-code.js"></script>

<script async src="../../../js/external-link.js"></script>

<script async src="../../../js/alt-title.js"></script>

<script async src="../../../js/header-link.js"></script>


<script async src="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>




  
  
  

  <div class="copyright"><a href="../../../tags/index.html"><i class='fab fa-github fa-1x'></i></a> · © <a href="../../../">Guankui Liu</a> 2019 </div>
  
  

  
  </footer>
  </article>
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-112592341-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

